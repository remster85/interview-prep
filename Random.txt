SELECT 
    -- Extract last character of 'firm'
    RIGHT(firm, 1) || 
    -- Build the suffix based on the trimmed 'account'
    CASE 
        WHEN TRIM(account) LIKE ' %' THEN '0000' || TRIM(account)
        ELSE SUBSTRING('0000' || TRIM(account) FROM 1 FOR 2)
    END AS recalculated_foa
FROM your_table;
